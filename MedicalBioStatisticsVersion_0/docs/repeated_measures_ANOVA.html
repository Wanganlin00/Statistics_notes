<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.32">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>8&nbsp; 重复测量方差分析 – 医学与生物统计学</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./proportion_test.html" rel="next">
<link href="./ANOVA.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-2486e1f0a3ee9ee1fc393803a1361cdb.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-6561bbde787c299e21493071c8edc6ff.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-69a30c073420f475066ff0fd08b8a642.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script><link rel="stylesheet" href="style.css">
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./hypothesis_test.html">假设检验</a></li><li class="breadcrumb-item"><a href="./repeated_measures_anova.html"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">重复测量方差分析</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">医学与生物统计学</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">前言</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./descriptive_statistics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">描述性统计学</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./quantitative_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">定量数据的统计描述</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./qualitative_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">定性数据的统计描述</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./correlation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">相关性</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./hypothesis_test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">假设检验</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./normality_test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">正态性检验</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./variance_homogeneity_test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">方差齐性检验</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./t_test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">t 检验</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ANOVA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">方差分析</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./repeated_measures_anova.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">重复测量方差分析</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./proportion_test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">比例检验</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chi-square_test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title"><span class="math inline">\(\chi^2\)</span> 检验</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./nonparametric_test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">非参数检验</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">统计模型</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./simple_linear_regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">线性回归</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./multiple_linear_regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">多元线性回归</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./LMM.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">线性混合效应模型</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./GLM.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">广义线性模型</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./GEE.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">广义估计方程</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">生存分析</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./SurvivalAnalysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">生存分析</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./CoxProportionalHazardsModel.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Cox比例风险模型</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./CompetingRiskModel.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">竞争风险模型</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">临床研究设计</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./diagnostic_test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">诊断性测试</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./RCT.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">随机对照试验</span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#%E5%81%87%E8%AE%BE" id="toc-假设" class="nav-link active" data-scroll-target="#%E5%81%87%E8%AE%BE"><span class="header-section-number">8.1</span> 假设</a></li>
  <li>
<a href="#%E5%8D%95%E5%9B%A0%E7%B4%A0%E9%87%8D%E5%A4%8D%E6%B5%8B%E9%87%8F%E6%96%B9%E5%B7%AE%E5%88%86%E6%9E%90" id="toc-单因素重复测量方差分析" class="nav-link" data-scroll-target="#%E5%8D%95%E5%9B%A0%E7%B4%A0%E9%87%8D%E5%A4%8D%E6%B5%8B%E9%87%8F%E6%96%B9%E5%B7%AE%E5%88%86%E6%9E%90"><span class="header-section-number">8.2</span> 单因素重复测量方差分析</a>
  <ul>
<li><a href="#%E5%85%AC%E5%BC%8F" id="toc-公式" class="nav-link" data-scroll-target="#%E5%85%AC%E5%BC%8F"><span class="header-section-number">8.2.1</span> 公式</a></li>
  <li><a href="#nlmelme" id="toc-nlmelme" class="nav-link" data-scroll-target="#nlmelme"><span class="header-section-number">8.2.2</span> <code>nlme::lme()</code></a></li>
  </ul>
</li>
  <li>
<a href="#%E5%90%AB%E7%BB%84%E9%97%B4%E5%9B%A0%E5%AD%90%E7%9A%84%E9%87%8D%E5%A4%8D%E6%B5%8B%E9%87%8F%E6%96%B9%E5%B7%AE%E5%88%86%E6%9E%90" id="toc-含组间因子的重复测量方差分析" class="nav-link" data-scroll-target="#%E5%90%AB%E7%BB%84%E9%97%B4%E5%9B%A0%E5%AD%90%E7%9A%84%E9%87%8D%E5%A4%8D%E6%B5%8B%E9%87%8F%E6%96%B9%E5%B7%AE%E5%88%86%E6%9E%90"><span class="header-section-number">8.3</span> 含组间因子的重复测量方差分析</a>
  <ul>
<li><a href="#%E5%85%AC%E5%BC%8F-1" id="toc-公式-1" class="nav-link" data-scroll-target="#%E5%85%AC%E5%BC%8F-1"><span class="header-section-number">8.3.1</span> 公式</a></li>
  <li>
<a href="#%E6%A1%88%E4%BE%8B" id="toc-案例" class="nav-link" data-scroll-target="#%E6%A1%88%E4%BE%8B"><span class="header-section-number">8.3.2</span> 案例</a>
  <ul class="collapse">
<li><a href="#nlmelme-1" id="toc-nlmelme-1" class="nav-link" data-scroll-target="#nlmelme-1"><span class="header-section-number">8.3.2.1</span> <code>nlme::lme()</code></a></li>
  <li><a href="#rstatixanova_test-%E7%9C%8B%E7%90%83%E5%BD%A2%E6%A3%80%E9%AA%8C-w%E7%BB%9F%E8%AE%A1%E9%87%8F" id="toc-rstatixanova_test-看球形检验-w统计量" class="nav-link" data-scroll-target="#rstatixanova_test-%E7%9C%8B%E7%90%83%E5%BD%A2%E6%A3%80%E9%AA%8C-w%E7%BB%9F%E8%AE%A1%E9%87%8F"><span class="header-section-number">8.3.2.2</span> <code>rstatix::anova_test()</code> 看球形检验 W统计量</a></li>
  <li><a href="#afexaov_%E7%9C%8B%E5%90%84%E6%97%B6%E9%97%B4%E7%82%B9%E5%A4%84%E7%90%86%E7%BB%84%E6%88%90%E5%AF%B9%E6%AF%94%E8%BE%83%E5%92%8C%E5%90%84%E5%A4%84%E7%90%86%E7%BB%84%E6%97%B6%E9%97%B4%E7%82%B9%E6%88%90%E5%AF%B9%E6%AF%94%E8%BE%83" id="toc-afexaov_看各时间点处理组成对比较和各处理组时间点成对比较" class="nav-link" data-scroll-target="#afexaov_%E7%9C%8B%E5%90%84%E6%97%B6%E9%97%B4%E7%82%B9%E5%A4%84%E7%90%86%E7%BB%84%E6%88%90%E5%AF%B9%E6%AF%94%E8%BE%83%E5%92%8C%E5%90%84%E5%A4%84%E7%90%86%E7%BB%84%E6%97%B6%E9%97%B4%E7%82%B9%E6%88%90%E5%AF%B9%E6%AF%94%E8%BE%83"><span class="header-section-number">8.3.2.3</span> <code>afex::aov_*()</code>看各时间点处理组成对比较和各处理组时间点成对比较</a></li>
  </ul>
</li>
  <li>
<a href="#%E5%88%86%E9%83%A8%E8%AE%A1%E7%AE%97" id="toc-分部计算" class="nav-link" data-scroll-target="#%E5%88%86%E9%83%A8%E8%AE%A1%E7%AE%97"><span class="header-section-number">8.3.3</span> 分部计算</a>
  <ul class="collapse">
<li><a href="#ss%E6%80%BB" id="toc-ss总" class="nav-link" data-scroll-target="#ss%E6%80%BB"><span class="header-section-number">8.3.3.1</span> SS<sub>总</sub></a></li>
  <li><a href="#ss%E5%8F%97%E8%AF%95%E5%AF%B9%E8%B1%A1%E9%97%B4" id="toc-ss受试对象间" class="nav-link" data-scroll-target="#ss%E5%8F%97%E8%AF%95%E5%AF%B9%E8%B1%A1%E9%97%B4"><span class="header-section-number">8.3.3.2</span> SS<sub>受试对象间</sub></a></li>
  <li><a href="#ss%E5%8F%97%E8%AF%95%E5%AF%B9%E8%B1%A1%E5%86%85" id="toc-ss受试对象内" class="nav-link" data-scroll-target="#ss%E5%8F%97%E8%AF%95%E5%AF%B9%E8%B1%A1%E5%86%85"><span class="header-section-number">8.3.3.3</span> SS<sub>受试对象内</sub></a></li>
  </ul>
</li>
  </ul>
</li>
  <li>
<a href="#%E7%90%83%E5%BD%A2%E5%BA%A6%E6%A3%80%E9%AA%8C-sphericity" id="toc-球形度检验-sphericity" class="nav-link" data-scroll-target="#%E7%90%83%E5%BD%A2%E5%BA%A6%E6%A3%80%E9%AA%8C-sphericity"><span class="header-section-number">8.4</span> 球形度检验 sphericity</a>
  <ul>
<li><a href="#%E8%AE%A1%E7%AE%97%E6%AD%A5%E9%AA%A4" id="toc-计算步骤" class="nav-link" data-scroll-target="#%E8%AE%A1%E7%AE%97%E6%AD%A5%E9%AA%A4"><span class="header-section-number">8.4.1</span> 计算步骤</a></li>
  <li>
<a href="#%E6%A1%88%E4%BE%8B-1" id="toc-案例-1" class="nav-link" data-scroll-target="#%E6%A1%88%E4%BE%8B-1"><span class="header-section-number">8.4.2</span> 案例</a>
  <ul class="collapse">
<li><a href="#rstatixanova_test" id="toc-rstatixanova_test" class="nav-link" data-scroll-target="#rstatixanova_test"><span class="header-section-number">8.4.2.1</span> <code>rstatix::anova_test()</code></a></li>
  <li><a href="#ezezanova" id="toc-ezezanova" class="nav-link" data-scroll-target="#ezezanova"><span class="header-section-number">8.4.2.2</span> <code>ez::ezANOVA()</code></a></li>
  </ul>
</li>
  <li><a href="#%E5%BD%93%E6%BB%A1%E8%B6%B3%E7%90%83%E5%BD%A2%E5%BA%A6%E5%81%87%E8%AE%BE%E6%97%B6" id="toc-当满足球形度假设时" class="nav-link" data-scroll-target="#%E5%BD%93%E6%BB%A1%E8%B6%B3%E7%90%83%E5%BD%A2%E5%BA%A6%E5%81%87%E8%AE%BE%E6%97%B6"><span class="header-section-number">8.4.3</span> <strong>当满足球形度假设时</strong></a></li>
  <li><a href="#%E5%BD%93%E8%BF%9D%E5%8F%8D%E7%90%83%E5%BD%A2%E5%BA%A6%E5%81%87%E8%AE%BE%E6%97%B6" id="toc-当违反球形度假设时" class="nav-link" data-scroll-target="#%E5%BD%93%E8%BF%9D%E5%8F%8D%E7%90%83%E5%BD%A2%E5%BA%A6%E5%81%87%E8%AE%BE%E6%97%B6"><span class="header-section-number">8.4.4</span> <strong>当违反球形度假设时</strong></a></li>
  </ul>
</li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./hypothesis_test.html">假设检验</a></li><li class="breadcrumb-item"><a href="./repeated_measures_anova.html"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">重复测量方差分析</span></a></li></ol></nav><div class="quarto-title">
<h1 class="title">
<span class="chapter-number">8</span>&nbsp; <span class="chapter-title">重复测量方差分析</span>
</h1>
</div>



<div class="quarto-title-meta">

    
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">November 20, 2024</p>
    </div>
  </div>
    
  </div>
  


</header><p>重复测量方差分析用于分析重复测量数据中组间和组内自变量对因变量的影响。模型形式为：</p>
<p><span class="math display">\[
Y_{ijk}=\mu +\alpha_i +\beta_j +(\alpha\beta)_{ij}+S_k+(\beta S)_{jk}+\epsilon_{ijk}
\]</span> 其中，<span class="math inline">\(Y_{ijk}\)</span> 是第i 个组、第j 个时间点或条件下、第k 个受试者的测量值，<span class="math inline">\(\alpha_i\)</span> 是组间效应，<span class="math inline">\(\beta_j\)</span> 时间效应或条件效应，<span class="math inline">\((\alpha\beta)_{ij}\)</span> 是组效应与时间效应的交互效应，<span class="math inline">\(S_k\)</span> 是第 k 个受试者的效应（通常被视为随机效应），<span class="math inline">\((\beta S)_{jk}\)</span> 是时间效应与受试者效应的交互作用（也通常被视为随机效应）， <span class="math inline">\(\epsilon_{ijk}\)</span> 是误差项。</p>
<ul>
<li><p><strong>总体均值</strong>： 代表所有观测值的平均值，是固定效应的一部分。</p></li>
<li><p><strong>组间效应</strong>： 反映不同组（如治疗组和对照组）之间的差异，是固定效应的一部分。</p></li>
<li><p><strong>时间效应(</strong>： 反映不同时间点或条件（如测量前、测量中、测量后）之间的差异，是固定效应的一部分。</p></li>
<li><p><strong>组间和时间效应的交互作用</strong>： 反映不同组在不同时间点或条件下的差异，是固定效应的一部分。</p></li>
<li><p><strong>受试者效应</strong>： 反映个体差异，考虑每个受试者的独特性，通常作为随机效应处理。</p></li>
<li><p><strong>时间效应与受试者效应的交互作用</strong>： 反映个体在不同时间点或条件下的反应差异，通常作为随机效应处理。</p></li>
<li><p><strong>误差项</strong>： 表示观测值中的随机误差或未解释的变异。</p></li>
</ul>
<section id="假设" class="level2" style="color:red" data-number="8.1"><h2 style="color:red" data-number="8.1" class="anchored" data-anchor-id="假设">
<span class="header-section-number">8.1</span> 假设</h2>
<ul>
<li><p>独立性，即不同受试者之间的观测值是独立的。</p></li>
<li><p>正态性，观测值在每个时间点或条件下的正态分布。</p></li>
<li><p>同一受试者的重复测量之间的相关性一致性。</p></li>
<li><p>各组内的方差齐性（sphericity），即组内相关性结构是已知的，通常假设为复合对称（compound symmetry）。<strong>协方差矩阵的球形检验（W=1）</strong></p></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p><strong>复合对称假设</strong>：RM-ANOVA假设误差项具有复合对称性，即组内相关性和方差齐性。如果复合对称假设不成立，结果可能不准确，可以使用更为灵活的线性混合模型（LMM）或广义估计方程（GEE）进行分析。</p></li>
<li><p><strong>检验方法</strong>：RM-ANOVA的主要检验方法包括F检验，用于检验组效应、时间效应和交互作用是否显著。</p></li>
</ul>
</div>
</div>
</section><section id="单因素重复测量方差分析" class="level2" data-number="8.2"><h2 data-number="8.2" class="anchored" data-anchor-id="单因素重复测量方差分析">
<span class="header-section-number">8.2</span> 单因素重复测量方差分析</h2>
<section id="公式" class="level3" data-number="8.2.1"><h3 data-number="8.2.1" class="anchored" data-anchor-id="公式">
<span class="header-section-number">8.2.1</span> 公式</h3>
<p><span class="math display">\[
SS_T=\sum_{j=1}^{t}\sum_{i=1}^{n}X_{ij}^2-\frac{(\sum_{j=1}^{t}\sum_{i=1}^{n}X_{ij})^2}{nt}=SS_{受试者间}+SS_{不同时间点}+SS_{E\ \ 随机误差}，\nu_T=nt-1
\]</span></p>
<p><span class="math display">\[
SS_{受试者间}=\frac{\sum_{i}(\sum_{j}X_{ij})^2}{t}-C，\nu_{受试者}=n-1
\]</span>反映了在受试者间的变异。</p>
<p><span class="math display">\[
SS_{不同时间点}=\frac{\sum_{j}(\sum_{i}X_{ij})^2}{n}-C ，\nu_{时间点}=t-1
\]</span>反映了在每个受试者内不同时间点的重复测量变异。</p>
<p><span class="math display">\[
SS_E=SS_T-SS_{受试者间}-SS_{不同时间点}，\nu_E=(n-1)(t-1)
\]</span></p>
<p><span class="math inline">\(H_0:\mu_1=\mu_2=...=\mu_t\)</span>，检验统计量</p>
<p><span class="math display">\[
F=\frac{MS_{不同时间点}}{MS_E}=\frac{SS_{不同时间点}/(t-1)}{SS_E/((n-1)(t-1))}
\]</span></p>
<div class="cell">
<details open="" class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ALT</span> <span class="op">&lt;-</span> <span class="fu">tribble</span><span class="op">(</span></span>
<span>    <span class="op">~</span><span class="va">id</span>,<span class="op">~</span><span class="va">zero</span>,<span class="op">~</span><span class="va">ten</span>,<span class="op">~</span><span class="va">twenty</span>,<span class="op">~</span><span class="va">thirty</span>,</span>
<span>    <span class="fl">1</span>,<span class="fl">186</span>,<span class="fl">122</span>,<span class="fl">134</span>,<span class="fl">110</span>,</span>
<span>    <span class="fl">2</span>,<span class="fl">345</span>,<span class="fl">312</span>,<span class="fl">268</span>,<span class="fl">176</span>,</span>
<span>    <span class="fl">3</span>,<span class="fl">98</span>,<span class="fl">84</span>,<span class="fl">52</span>,<span class="fl">61</span>,</span>
<span>    <span class="fl">4</span>,<span class="fl">288</span>,<span class="fl">98</span>,<span class="fl">91</span>,<span class="fl">85</span>,</span>
<span>    <span class="fl">5</span>,<span class="fl">176</span>,<span class="fl">86</span>,<span class="fl">130</span>,<span class="fl">99</span>,</span>
<span>    <span class="fl">6</span>,<span class="fl">210</span>,<span class="fl">188</span>,<span class="fl">143</span>,<span class="fl">120</span>,</span>
<span>    <span class="fl">7</span>,<span class="fl">271</span>,<span class="fl">322</span>,<span class="fl">86</span>,<span class="fl">65</span>,</span>
<span>    <span class="fl">8</span>,<span class="fl">415</span>,<span class="fl">332</span>,<span class="fl">265</span>,<span class="fl">186</span>,</span>
<span>    <span class="fl">9</span>,<span class="fl">171</span>,<span class="fl">126</span>,<span class="fl">130</span>,<span class="fl">135</span>,</span>
<span>    <span class="fl">10</span>,<span class="fl">243</span>,<span class="fl">330</span>,<span class="fl">95</span>,<span class="fl">64</span>,</span>
<span><span class="op">)</span></span>
<span><span class="va">ALT_long</span> <span class="op">&lt;-</span></span>
<span>    <span class="va">ALT</span> <span class="op">|&gt;</span> <span class="fu">pivot_longer</span><span class="op">(</span>cols <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>,</span>
<span>                       names_to <span class="op">=</span> <span class="st">"week"</span>,</span>
<span>                       values_to <span class="op">=</span> <span class="st">"ALT"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">mutate</span><span class="op">(</span>week <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">week</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"zero"</span>,<span class="st">"ten"</span>, <span class="st">"twenty"</span>, <span class="st">"thirty"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># 假设检验</span></span>
<span><span class="va">ALT_long</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">group_by</span><span class="op">(</span><span class="va">week</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">rstatix</span><span class="fu">::</span><span class="fu"><a href="https://rpkgs.datanovia.com/rstatix/reference/shapiro_test.html">shapiro_test</a></span><span class="op">(</span><span class="va">ALT</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 4 × 4</span></span>
<span><span class="co">#&gt;   week   variable statistic      p</span></span>
<span><span class="co">#&gt;   &lt;fct&gt;  &lt;chr&gt;        &lt;dbl&gt;  &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 zero   ALT          0.972 0.906 </span></span>
<span><span class="co">#&gt; 2 ten    ALT          0.796 0.0131</span></span>
<span><span class="co">#&gt; 3 twenty ALT          0.834 0.0378</span></span>
<span><span class="co">#&gt; 4 thirty ALT          0.907 0.262</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 总变异</span></span>
<span><span class="va">xij_sum</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">ALT_long</span><span class="op">$</span><span class="va">ALT</span><span class="op">)</span></span>
<span><span class="va">xij_square_sum</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">ALT_long</span><span class="op">$</span><span class="va">ALT</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">C</span> <span class="op">&lt;-</span> <span class="va">xij_sum</span><span class="op">^</span><span class="fl">2</span><span class="op">/</span><span class="fl">40</span></span>
<span><span class="va">SS_T</span> <span class="op">&lt;-</span> <span class="va">xij_square_sum</span><span class="op">-</span><span class="va">C</span></span>
<span></span>
<span><span class="co"># 受试者间  </span></span>
<span><span class="va">xi._sum</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span><span class="op">(</span><span class="va">ALT</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">xi._sum</span></span>
<span><span class="co">#&gt;  [1]  552 1101  295  562  491  661  744 1198  562  732</span></span>
<span><span class="va">SS_B</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">xi._sum</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="fl">4</span><span class="op">-</span><span class="va">C</span> <span class="co">#行和平方和</span></span>
<span><span class="va">MS_B</span> <span class="op">&lt;-</span> <span class="va">SS_B</span><span class="op">/</span><span class="fl">9</span></span>
<span></span>
<span><span class="co"># 不同时间点</span></span>
<span><span class="va">x.j_sum</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">colSums</a></span><span class="op">(</span><span class="va">ALT</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">x.j_sum</span></span>
<span><span class="co">#&gt;   zero    ten twenty thirty </span></span>
<span><span class="co">#&gt;   2403   2000   1394   1101</span></span>
<span><span class="va">SS_W</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">x.j_sum</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span><span class="op">-</span><span class="va">C</span> <span class="co">#列和平方和</span></span>
<span><span class="va">MS_W</span> <span class="op">&lt;-</span> <span class="va">SS_W</span><span class="op">/</span><span class="fl">3</span></span>
<span></span>
<span></span>
<span></span>
<span><span class="va">SS_E</span> <span class="op">&lt;-</span> <span class="va">SS_T</span><span class="op">-</span><span class="va">SS_B</span><span class="op">-</span><span class="va">SS_W</span></span>
<span><span class="va">MS_E</span> <span class="op">&lt;-</span> <span class="va">SS_E</span><span class="op">/</span><span class="op">(</span><span class="fl">9</span><span class="op">*</span><span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="va">F_stat</span> <span class="op">&lt;-</span> <span class="va">MS_W</span><span class="op">/</span><span class="va">MS_E</span></span>
<span><span class="va">F_stat</span></span>
<span><span class="co">#&gt; [1] 11.13855</span></span>
<span></span>
<span><span class="va">v1</span> <span class="op">=</span> <span class="fl">4</span><span class="op">-</span><span class="fl">1</span></span>
<span><span class="va">v2</span> <span class="op">=</span> <span class="op">(</span><span class="fl">4</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="fl">10</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/Fdist.html">pf</a></span><span class="op">(</span><span class="va">F_stat</span>, df1 <span class="op">=</span> <span class="va">v1</span>, df2 <span class="op">=</span> <span class="va">v2</span>, lower.tail <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 6.170758e-05</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"F统计量："</span>, <span class="va">F_stat</span>, <span class="st">"\n"</span>,</span>
<span>    <span class="st">"p值："</span>,<span class="fu"><a href="https://rdrr.io/r/stats/Fdist.html">pf</a></span><span class="op">(</span><span class="va">F_stat</span>, df1 <span class="op">=</span> <span class="va">v1</span>, df2 <span class="op">=</span> <span class="va">v2</span>, lower.tail <span class="op">=</span> <span class="cn">F</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; F统计量： 11.13855 </span></span>
<span><span class="co">#&gt;  p值： 6.170758e-05</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="nlmelme" class="level3" data-number="8.2.2"><h3 data-number="8.2.2" class="anchored" data-anchor-id="nlmelme">
<span class="header-section-number">8.2.2</span> <code>nlme::lme()</code>
</h3>
<div class="cell">
<details open="" class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://svn.r-project.org/R-packages/trunk/nlme/">nlme</a></span><span class="op">)</span></span>
<span><span class="va">ALT_lme</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/lme.html">lme</a></span><span class="op">(</span>fixed<span class="op">=</span><span class="va">ALT</span> <span class="op">~</span> <span class="va">week</span>, random <span class="op">=</span> <span class="op">~</span><span class="fl">1</span><span class="op">|</span> <span class="va">id</span><span class="op">/</span><span class="va">week</span>, data <span class="op">=</span> <span class="va">ALT_long</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ALT_aov</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/anova.lme.html">anova.lme</a></span><span class="op">(</span><span class="va">ALT_lme</span><span class="op">)</span></span>
<span><span class="va">ALT_aov</span> </span>
<span><span class="co">#&gt;             numDF denDF  F-value p-value</span></span>
<span><span class="co">#&gt; (Intercept)     1    27 62.98194  &lt;.0001</span></span>
<span><span class="co">#&gt; week            3    27 11.13855   1e-04</span></span>
<span><span class="va">ALT_aov</span><span class="op">$</span><span class="va">`p-value`</span></span>
<span><span class="co">#&gt; [1] 1.569667e-08 6.170758e-05</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><span style="color:red">事后检验</span></p>
<div class="cell">
<details open="" class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#成对比较</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rvlenth.github.io/emmeans/">emmeans</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rvlenth.github.io/emmeans/reference/emmeans.html">emmeans</a></span><span class="op">(</span><span class="va">ALT_lme</span>, <span class="va">pairwise</span> <span class="op">~</span><span class="va">week</span>, adjust <span class="op">=</span> <span class="st">"bonferroni"</span><span class="op">)</span> </span>
<span><span class="co">#&gt; $emmeans</span></span>
<span><span class="co">#&gt;  week   emmean   SE df lower.CL upper.CL</span></span>
<span><span class="co">#&gt;  zero      240 26.5  9    180.3      300</span></span>
<span><span class="co">#&gt;  ten       200 26.5  9    140.0      260</span></span>
<span><span class="co">#&gt;  twenty    139 26.5  9     79.4      199</span></span>
<span><span class="co">#&gt;  thirty    110 26.5  9     50.1      170</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Degrees-of-freedom method: containment </span></span>
<span><span class="co">#&gt; Confidence level used: 0.95 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $contrasts</span></span>
<span><span class="co">#&gt;  contrast        estimate   SE df t.ratio p.value</span></span>
<span><span class="co">#&gt;  zero - ten          40.3 24.9 27   1.620  0.7014</span></span>
<span><span class="co">#&gt;  zero - twenty      100.9 24.9 27   4.055  0.0023</span></span>
<span><span class="co">#&gt;  zero - thirty      130.2 24.9 27   5.233  0.0001</span></span>
<span><span class="co">#&gt;  ten - twenty        60.6 24.9 27   2.436  0.1305</span></span>
<span><span class="co">#&gt;  ten - thirty        89.9 24.9 27   3.613  0.0073</span></span>
<span><span class="co">#&gt;  twenty - thirty     29.3 24.9 27   1.178  1.0000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Degrees-of-freedom method: containment </span></span>
<span><span class="co">#&gt; P value adjustment: bonferroni method for 6 tests</span></span>
<span><span class="fu"><a href="https://rvlenth.github.io/emmeans/reference/emmeans.html">emmeans</a></span><span class="op">(</span><span class="va">ALT_lme</span>,  <span class="op">~</span><span class="va">week</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html">pairs</a></span><span class="op">(</span><span class="va">.</span>, adjust <span class="op">=</span> <span class="st">"bonferroni"</span><span class="op">)</span></span>
<span><span class="co">#&gt;  contrast        estimate   SE df t.ratio p.value</span></span>
<span><span class="co">#&gt;  zero - ten          40.3 24.9 27   1.620  0.7014</span></span>
<span><span class="co">#&gt;  zero - twenty      100.9 24.9 27   4.055  0.0023</span></span>
<span><span class="co">#&gt;  zero - thirty      130.2 24.9 27   5.233  0.0001</span></span>
<span><span class="co">#&gt;  ten - twenty        60.6 24.9 27   2.436  0.1305</span></span>
<span><span class="co">#&gt;  ten - thirty        89.9 24.9 27   3.613  0.0073</span></span>
<span><span class="co">#&gt;  twenty - thirty     29.3 24.9 27   1.178  1.0000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Degrees-of-freedom method: containment </span></span>
<span><span class="co">#&gt; P value adjustment: bonferroni method for 6 tests</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://multcomp.R-forge.R-project.org">multcomp</a></span><span class="op">)</span></span>
<span><span class="va">ALT_posthoc</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/multcomp/man/glht.html">glht</a></span><span class="op">(</span><span class="va">ALT_lme</span>, linfct <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/multcomp/man/glht.html">mcp</a></span><span class="op">(</span>week <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"zero - ten = 0 "</span>,</span>
<span>                                               <span class="st">"twenty - zero == 0"</span>,</span>
<span>                                               <span class="st">"thirty - zero = 0 "</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">ALT_posthoc</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 3 × 7</span></span>
<span><span class="co">#&gt;   term  contrast      null.value estimate std.error statistic adj.p.value</span></span>
<span><span class="co">#&gt;   &lt;chr&gt; &lt;chr&gt;              &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;       &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 week  zero - ten             0     40.3      24.9      1.62 0.248      </span></span>
<span><span class="co">#&gt; 2 week  twenty - zero          0   -101.       24.9     -4.06 0.000167   </span></span>
<span><span class="co">#&gt; 3 week  thirty - zero          0   -130.       24.9     -5.23 0.000000418</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section></section><section id="含组间因子的重复测量方差分析" class="level2" data-number="8.3"><h2 data-number="8.3" class="anchored" data-anchor-id="含组间因子的重复测量方差分析">
<span class="header-section-number">8.3</span> 含组间因子的重复测量方差分析</h2>
<section id="公式-1" class="level3" data-number="8.3.1"><h3 data-number="8.3.1" class="anchored" data-anchor-id="公式-1">
<span class="header-section-number">8.3.1</span> 公式</h3>
<p><span class="math display">\[
\begin{aligned}
SS_总&amp;= SS_{受试对象间}+SS_{受试对象内}  \\
&amp;=（SS_{处理方法}+SS_{个体间差异}）+（SS_{时间}+SS_{处理与时间交互}+SS_{个体内差异}）
\end{aligned}
\]</span></p>
<p><a href="https://personality-project.org/r/r.guide/r.anova.html#oneway" class="uri">https://personality-project.org/r/r.guide/r.anova.html#oneway</a></p>
</section><section id="案例" class="level3" data-number="8.3.2"><h3 data-number="8.3.2" class="anchored" data-anchor-id="案例">
<span class="header-section-number">8.3.2</span> 案例</h3>
<p>孙振球（医学统计学第四版 人卫版，例12-3，P193）</p>
<div class="cell">
<details open="" class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 医学统计学 人卫版 第7版</span></span>
<span><span class="va">SBP</span> <span class="op">&lt;-</span> <span class="fu">read_tsv</span><span class="op">(</span><span class="st">"data/麻醉诱导时相.tsv"</span><span class="op">)</span></span>
<span><span class="va">SBP</span></span>
<span><span class="co">#&gt; # A tibble: 15 × 7</span></span>
<span><span class="co">#&gt;       id group    t0    t1    t2    t3    t4</span></span>
<span><span class="co">#&gt;    &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1     1 A       120   108   112   120   117</span></span>
<span><span class="co">#&gt;  2     2 A       118   109   115   126   123</span></span>
<span><span class="co">#&gt;  3     3 A       119   112   119   124   118</span></span>
<span><span class="co">#&gt;  4     4 A       121   112   119   126   120</span></span>
<span><span class="co">#&gt;  5     5 A       127   121   127   133   126</span></span>
<span><span class="co">#&gt;  6     6 B       121   120   118   131   137</span></span>
<span><span class="co">#&gt;  7     7 B       122   121   119   129   133</span></span>
<span><span class="co">#&gt;  8     8 B       128   129   126   135   142</span></span>
<span><span class="co">#&gt;  9     9 B       117   115   111   123   131</span></span>
<span><span class="co">#&gt; 10    10 B       118   114   116   123   133</span></span>
<span><span class="co">#&gt; 11    11 C       131   119   118   135   129</span></span>
<span><span class="co">#&gt; 12    12 C       129   128   121   148   132</span></span>
<span><span class="co">#&gt; 13    13 C       123   123   120   143   136</span></span>
<span><span class="co">#&gt; 14    14 C       123   121   116   145   126</span></span>
<span><span class="co">#&gt; 15    15 C       125   124   118   142   130</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">SBP_long</span> <span class="op">&lt;-</span> <span class="va">SBP</span> <span class="op">|&gt;</span> <span class="fu">pivot_longer</span><span class="op">(</span>cols <span class="op">=</span> <span class="fu">starts_with</span><span class="op">(</span><span class="st">"t"</span><span class="op">)</span>,</span>
<span>                              names_to <span class="op">=</span> <span class="st">"time"</span>,</span>
<span>                              values_to <span class="op">=</span> <span class="st">"SBP"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">mutate</span><span class="op">(</span></span>
<span>        id<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span>,</span>
<span>        group<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">group</span><span class="op">)</span>,</span>
<span>        time<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="va">SBP_long</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 4</span></span>
<span><span class="co">#&gt;   id    group time    SBP</span></span>
<span><span class="co">#&gt;   &lt;fct&gt; &lt;fct&gt; &lt;fct&gt; &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 1     A     t0      120</span></span>
<span><span class="co">#&gt; 2 1     A     t1      108</span></span>
<span><span class="co">#&gt; 3 1     A     t2      112</span></span>
<span><span class="co">#&gt; 4 1     A     t3      120</span></span>
<span><span class="co">#&gt; 5 1     A     t4      117</span></span>
<span><span class="co">#&gt; 6 2     A     t0      118</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 正态性检验</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rpkgs.datanovia.com/rstatix/">rstatix</a></span><span class="op">)</span></span>
<span><span class="va">SBP_long</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">group</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://rpkgs.datanovia.com/rstatix/reference/shapiro_test.html">shapiro_test</a></span><span class="op">(</span><span class="va">SBP</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 15 × 5</span></span>
<span><span class="co">#&gt;    group time  variable statistic     p</span></span>
<span><span class="co">#&gt;    &lt;fct&gt; &lt;fct&gt; &lt;chr&gt;        &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 A     t0    SBP          0.836 0.154</span></span>
<span><span class="co">#&gt;  2 B     t0    SBP          0.916 0.503</span></span>
<span><span class="co">#&gt;  3 C     t0    SBP          0.867 0.254</span></span>
<span><span class="co">#&gt;  4 A     t1    SBP          0.834 0.148</span></span>
<span><span class="co">#&gt;  5 B     t1    SBP          0.913 0.485</span></span>
<span><span class="co">#&gt;  6 C     t1    SBP          0.978 0.921</span></span>
<span><span class="co">#&gt;  7 A     t2    SBP          0.940 0.666</span></span>
<span><span class="co">#&gt;  8 B     t2    SBP          0.969 0.869</span></span>
<span><span class="co">#&gt;  9 C     t2    SBP          0.953 0.758</span></span>
<span><span class="co">#&gt; 10 A     t3    SBP          0.937 0.647</span></span>
<span><span class="co">#&gt; 11 B     t3    SBP          0.902 0.421</span></span>
<span><span class="co">#&gt; 12 C     t3    SBP          0.941 0.672</span></span>
<span><span class="co">#&gt; 13 A     t4    SBP          0.943 0.687</span></span>
<span><span class="co">#&gt; 14 B     t4    SBP          0.892 0.367</span></span>
<span><span class="co">#&gt; 15 C     t4    SBP          0.984 0.955</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="nlmelme-1" class="level4" data-number="8.3.2.1"><h4 data-number="8.3.2.1" class="anchored" data-anchor-id="nlmelme-1">
<span class="header-section-number">8.3.2.1</span> <code>nlme::lme()</code>
</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 第一种方法</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://svn.r-project.org/R-packages/trunk/nlme/">nlme</a></span><span class="op">)</span></span>
<span><span class="va">SBP_lme</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/lme.html">lme</a></span><span class="op">(</span><span class="va">SBP</span> <span class="op">~</span> <span class="va">group</span><span class="op">*</span><span class="va">time</span>, random <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">|</span><span class="va">id</span><span class="op">/</span><span class="va">time</span>, data <span class="op">=</span> <span class="va">SBP_long</span><span class="op">)</span></span>
<span><span class="co"># summary(SBP_lme)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">SBP_lme</span><span class="op">)</span></span>
<span><span class="co">#&gt;             numDF denDF   F-value p-value</span></span>
<span><span class="co">#&gt; (Intercept)     1    48 14649.223  &lt;.0001</span></span>
<span><span class="co">#&gt; group           2    12     5.783  0.0174</span></span>
<span><span class="co">#&gt; time            4    48   106.558  &lt;.0001</span></span>
<span><span class="co">#&gt; group:time      8    48    19.101  &lt;.0001</span></span>
<span><span class="co"># 看不到球形检验</span></span>
<span></span>
<span></span>
<span><span class="co"># 事后检验 成对比较</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rvlenth.github.io/emmeans/">emmeans</a></span><span class="op">)</span></span>
<span><span class="co"># 如果交互效应不显著</span></span>
<span></span>
<span><span class="co">## 时间点事后检验</span></span>
<span><span class="va">SBP_long</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rpkgs.datanovia.com/rstatix/reference/t_test.html">pairwise_t_test</a></span><span class="op">(</span><span class="va">SBP</span> <span class="op">~</span> <span class="va">time</span>, p.adjust.method <span class="op">=</span> <span class="st">"none"</span>, detailed <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 10 × 10</span></span>
<span><span class="co">#&gt;    .y.   group1 group2    n1    n2        p method   p.adj p.signif p.adj.signif</span></span>
<span><span class="co">#&gt;  * &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;  &lt;int&gt; &lt;int&gt;    &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;       </span></span>
<span><span class="co">#&gt;  1 SBP   t0     t1        15    15  6.81e-2 T-test 6.81e-2 ns       ns          </span></span>
<span><span class="co">#&gt;  2 SBP   t0     t2        15    15  6.41e-2 T-test 6.41e-2 ns       ns          </span></span>
<span><span class="co">#&gt;  3 SBP   t1     t2        15    15  9.78e-1 T-test 9.78e-1 ns       ns          </span></span>
<span><span class="co">#&gt;  4 SBP   t0     t3        15    15  1.78e-4 T-test 1.78e-4 ***      ***         </span></span>
<span><span class="co">#&gt;  5 SBP   t1     t3        15    15  1.67e-7 T-test 1.67e-7 ****     ****        </span></span>
<span><span class="co">#&gt;  6 SBP   t2     t3        15    15  1.49e-7 T-test 1.49e-7 ****     ****        </span></span>
<span><span class="co">#&gt;  7 SBP   t0     t4        15    15  1.28e-2 T-test 1.28e-2 *        *           </span></span>
<span><span class="co">#&gt;  8 SBP   t1     t4        15    15  3.68e-5 T-test 3.68e-5 ****     ****        </span></span>
<span><span class="co">#&gt;  9 SBP   t2     t4        15    15  3.32e-5 T-test 3.32e-5 ****     ****        </span></span>
<span><span class="co">#&gt; 10 SBP   t3     t4        15    15  1.65e-1 T-test 1.65e-1 ns       ns</span></span>
<span></span>
<span><span class="fu"><a href="https://rvlenth.github.io/emmeans/reference/emmeans.html">emmeans</a></span><span class="op">(</span><span class="va">SBP_lme</span>,<span class="va">pairwise</span> <span class="op">~</span><span class="va">time</span>, adjust <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span>  </span>
<span><span class="co">#&gt; $emmeans</span></span>
<span><span class="co">#&gt;  time emmean   SE df lower.CL upper.CL</span></span>
<span><span class="co">#&gt;  t0      123 1.16 12      120      125</span></span>
<span><span class="co">#&gt;  t1      118 1.16 12      116      121</span></span>
<span><span class="co">#&gt;  t2      118 1.16 12      116      121</span></span>
<span><span class="co">#&gt;  t3      132 1.16 12      130      135</span></span>
<span><span class="co">#&gt;  t4      129 1.16 12      126      131</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Results are averaged over the levels of: group </span></span>
<span><span class="co">#&gt; Degrees-of-freedom method: containment </span></span>
<span><span class="co">#&gt; Confidence level used: 0.95 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $contrasts</span></span>
<span><span class="co">#&gt;  contrast estimate    SE df t.ratio p.value</span></span>
<span><span class="co">#&gt;  t0 - t1    4.4000 0.855 48   5.147  &lt;.0001</span></span>
<span><span class="co">#&gt;  t0 - t2    4.4667 0.855 48   5.225  &lt;.0001</span></span>
<span><span class="co">#&gt;  t0 - t3   -9.4000 0.855 48 -10.995  &lt;.0001</span></span>
<span><span class="co">#&gt;  t0 - t4   -6.0667 0.855 48  -7.096  &lt;.0001</span></span>
<span><span class="co">#&gt;  t1 - t2    0.0667 0.855 48   0.078  0.9382</span></span>
<span><span class="co">#&gt;  t1 - t3  -13.8000 0.855 48 -16.142  &lt;.0001</span></span>
<span><span class="co">#&gt;  t1 - t4  -10.4667 0.855 48 -12.243  &lt;.0001</span></span>
<span><span class="co">#&gt;  t2 - t3  -13.8667 0.855 48 -16.220  &lt;.0001</span></span>
<span><span class="co">#&gt;  t2 - t4  -10.5333 0.855 48 -12.321  &lt;.0001</span></span>
<span><span class="co">#&gt;  t3 - t4    3.3333 0.855 48   3.899  0.0003</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Results are averaged over the levels of: group </span></span>
<span><span class="co">#&gt; Degrees-of-freedom method: containment</span></span>
<span></span>
<span><span class="co">## 组间事后检验</span></span>
<span><span class="fu"><a href="https://rvlenth.github.io/emmeans/reference/emmeans.html">emmeans</a></span><span class="op">(</span><span class="va">SBP_lme</span>,<span class="va">pairwise</span> <span class="op">~</span><span class="va">group</span>, adjust <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span>  <span class="co"># 与spss一样</span></span>
<span><span class="co">#&gt; $emmeans</span></span>
<span><span class="co">#&gt;  group emmean   SE df lower.CL upper.CL</span></span>
<span><span class="co">#&gt;  A        120 1.78 14      116      123</span></span>
<span><span class="co">#&gt;  B        124 1.78 12      121      128</span></span>
<span><span class="co">#&gt;  C        128 1.78 12      124      132</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Results are averaged over the levels of: time </span></span>
<span><span class="co">#&gt; Degrees-of-freedom method: containment </span></span>
<span><span class="co">#&gt; Confidence level used: 0.95 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $contrasts</span></span>
<span><span class="co">#&gt;  contrast estimate   SE df t.ratio p.value</span></span>
<span><span class="co">#&gt;  A - B       -4.80 2.51 12  -1.911  0.0802</span></span>
<span><span class="co">#&gt;  A - C       -8.52 2.51 12  -3.392  0.0054</span></span>
<span><span class="co">#&gt;  B - C       -3.72 2.51 12  -1.481  0.1644</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Results are averaged over the levels of: time </span></span>
<span><span class="co">#&gt; Degrees-of-freedom method: containment</span></span>
<span></span>
<span><span class="co"># 此处交互效应显著</span></span>
<span><span class="co"># 1. 简单组别效应 与SPSS一样</span></span>
<span><span class="va">SBP_long</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rpkgs.datanovia.com/rstatix/reference/anova_test.html">anova_test</a></span><span class="op">(</span><span class="va">SBP</span><span class="op">~</span><span class="va">group</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 5 × 8</span></span>
<span><span class="co">#&gt;   time  Effect   DFn   DFd      F        p `p&lt;.05`   ges</span></span>
<span><span class="co">#&gt; * &lt;fct&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;   &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 t0    group      2    12  2.93  0.092    ""      0.328</span></span>
<span><span class="co">#&gt; 2 t1    group      2    12  6.03  0.015    "*"     0.501</span></span>
<span><span class="co">#&gt; 3 t2    group      2    12  0.022 0.979    ""      0.004</span></span>
<span><span class="co">#&gt; 4 t3    group      2    12 17.0   0.000312 "*"     0.74 </span></span>
<span><span class="co">#&gt; 5 t4    group      2    12 17.4   0.000286 "*"     0.743</span></span>
<span></span>
<span><span class="co"># 2. 各时间点处理组成对比较  用的是未调整的p值，无法观察到标准误</span></span>
<span><span class="va">SBP_long</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rpkgs.datanovia.com/rstatix/reference/t_test.html">pairwise_t_test</a></span><span class="op">(</span><span class="va">SBP</span> <span class="op">~</span> <span class="va">group</span>, </span>
<span>                  p.adjust.method <span class="op">=</span> <span class="st">"bonferroni"</span>, detailed <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 15 × 11</span></span>
<span><span class="co">#&gt;    time  .y.   group1 group2    n1    n2         p method    p.adj p.signif</span></span>
<span><span class="co">#&gt;  * &lt;fct&gt; &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;  &lt;int&gt; &lt;int&gt;     &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt;   </span></span>
<span><span class="co">#&gt;  1 t0    SBP   A      B          5     5 0.936     T-test 1        ns      </span></span>
<span><span class="co">#&gt;  2 t0    SBP   A      C          5     5 0.0539    T-test 0.162    ns      </span></span>
<span><span class="co">#&gt;  3 t0    SBP   B      C          5     5 0.0623    T-test 0.187    ns      </span></span>
<span><span class="co">#&gt;  4 t1    SBP   A      B          5     5 0.0358    T-test 0.107    *       </span></span>
<span><span class="co">#&gt;  5 t1    SBP   A      C          5     5 0.00541   T-test 0.0162   **      </span></span>
<span><span class="co">#&gt;  6 t1    SBP   B      C          5     5 0.327     T-test 0.981    ns      </span></span>
<span><span class="co">#&gt;  7 t2    SBP   A      B          5     5 0.894     T-test 1        ns      </span></span>
<span><span class="co">#&gt;  8 t2    SBP   A      C          5     5 0.947     T-test 1        ns      </span></span>
<span><span class="co">#&gt;  9 t2    SBP   B      C          5     5 0.842     T-test 1        ns      </span></span>
<span><span class="co">#&gt; 10 t3    SBP   A      B          5     5 0.456     T-test 1        ns      </span></span>
<span><span class="co">#&gt; 11 t3    SBP   A      C          5     5 0.000161  T-test 0.000483 ***     </span></span>
<span><span class="co">#&gt; 12 t3    SBP   B      C          5     5 0.000585  T-test 0.00175  ***     </span></span>
<span><span class="co">#&gt; 13 t4    SBP   A      B          5     5 0.0000887 T-test 0.000266 ****    </span></span>
<span><span class="co">#&gt; 14 t4    SBP   A      C          5     5 0.00201   T-test 0.00602  **      </span></span>
<span><span class="co">#&gt; 15 t4    SBP   B      C          5     5 0.0901    T-test 0.27     ns      </span></span>
<span><span class="co">#&gt; # ℹ 1 more variable: p.adj.signif &lt;chr&gt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="rstatixanova_test-看球形检验-w统计量" class="level4" data-number="8.3.2.2"><h4 data-number="8.3.2.2" class="anchored" data-anchor-id="rstatixanova_test-看球形检验-w统计量">
<span class="header-section-number">8.3.2.2</span> <code>rstatix::anova_test()</code> 看球形检验 W统计量</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rpkgs.datanovia.com/rstatix/">rstatix</a></span><span class="op">)</span></span>
<span><span class="va">aov_SBP</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rpkgs.datanovia.com/rstatix/reference/anova_test.html">anova_test</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">SBP_long</span>,</span>
<span>           dv <span class="op">=</span> <span class="va">SBP</span>,</span>
<span>           wid <span class="op">=</span> <span class="va">id</span>,</span>
<span>           within <span class="op">=</span> <span class="va">time</span>,</span>
<span>           between <span class="op">=</span> <span class="va">group</span>,</span>
<span>           type <span class="op">=</span> <span class="st">"3"</span></span>
<span>           <span class="op">)</span></span>
<span></span>
<span><span class="va">aov_SBP</span></span>
<span><span class="co">#&gt; ANOVA Table (type III tests)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $ANOVA</span></span>
<span><span class="co">#&gt;       Effect DFn DFd       F        p p&lt;.05   ges</span></span>
<span><span class="co">#&gt; 1      group   2  12   5.783 1.70e-02     * 0.430</span></span>
<span><span class="co">#&gt; 2       time   4  48 106.558 3.02e-23     * 0.659</span></span>
<span><span class="co">#&gt; 3 group:time   8  48  19.101 1.62e-12     * 0.409</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`Mauchly's Test for Sphericity`</span></span>
<span><span class="co">#&gt;       Effect     W     p p&lt;.05</span></span>
<span><span class="co">#&gt; 1       time 0.293 0.178      </span></span>
<span><span class="co">#&gt; 2 group:time 0.293 0.178      </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`Sphericity Corrections`</span></span>
<span><span class="co">#&gt;       Effect   GGe      DF[GG]    p[GG] p[GG]&lt;.05   HFe      DF[HF]    p[HF]</span></span>
<span><span class="co">#&gt; 1       time 0.679 2.71, 32.58 1.87e-16         * 0.896 3.59, 43.03 4.65e-21</span></span>
<span><span class="co">#&gt; 2 group:time 0.679 5.43, 32.58 4.26e-09         * 0.896 7.17, 43.03 2.04e-11</span></span>
<span><span class="co">#&gt;   p[HF]&lt;.05</span></span>
<span><span class="co">#&gt; 1         *</span></span>
<span><span class="co">#&gt; 2         *</span></span>
<span></span>
<span><span class="co"># 进行事后检验，若交互效应不显著</span></span>
<span></span>
<span><span class="va">SBP_long</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rpkgs.datanovia.com/rstatix/reference/t_test.html">pairwise_t_test</a></span><span class="op">(</span><span class="va">SBP</span> <span class="op">~</span> <span class="va">group</span>, p.adjust.method <span class="op">=</span> <span class="st">"bonferroni"</span>, detailed <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 15 × 11</span></span>
<span><span class="co">#&gt;    time  .y.   group1 group2    n1    n2         p method    p.adj p.signif</span></span>
<span><span class="co">#&gt;  * &lt;fct&gt; &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;  &lt;int&gt; &lt;int&gt;     &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt;   </span></span>
<span><span class="co">#&gt;  1 t0    SBP   A      B          5     5 0.936     T-test 1        ns      </span></span>
<span><span class="co">#&gt;  2 t0    SBP   A      C          5     5 0.0539    T-test 0.162    ns      </span></span>
<span><span class="co">#&gt;  3 t0    SBP   B      C          5     5 0.0623    T-test 0.187    ns      </span></span>
<span><span class="co">#&gt;  4 t1    SBP   A      B          5     5 0.0358    T-test 0.107    *       </span></span>
<span><span class="co">#&gt;  5 t1    SBP   A      C          5     5 0.00541   T-test 0.0162   **      </span></span>
<span><span class="co">#&gt;  6 t1    SBP   B      C          5     5 0.327     T-test 0.981    ns      </span></span>
<span><span class="co">#&gt;  7 t2    SBP   A      B          5     5 0.894     T-test 1        ns      </span></span>
<span><span class="co">#&gt;  8 t2    SBP   A      C          5     5 0.947     T-test 1        ns      </span></span>
<span><span class="co">#&gt;  9 t2    SBP   B      C          5     5 0.842     T-test 1        ns      </span></span>
<span><span class="co">#&gt; 10 t3    SBP   A      B          5     5 0.456     T-test 1        ns      </span></span>
<span><span class="co">#&gt; 11 t3    SBP   A      C          5     5 0.000161  T-test 0.000483 ***     </span></span>
<span><span class="co">#&gt; 12 t3    SBP   B      C          5     5 0.000585  T-test 0.00175  ***     </span></span>
<span><span class="co">#&gt; 13 t4    SBP   A      B          5     5 0.0000887 T-test 0.000266 ****    </span></span>
<span><span class="co">#&gt; 14 t4    SBP   A      C          5     5 0.00201   T-test 0.00602  **      </span></span>
<span><span class="co">#&gt; 15 t4    SBP   B      C          5     5 0.0901    T-test 0.27     ns      </span></span>
<span><span class="co">#&gt; # ℹ 1 more variable: p.adj.signif &lt;chr&gt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="afexaov_看各时间点处理组成对比较和各处理组时间点成对比较" class="level4" data-number="8.3.2.3"><h4 data-number="8.3.2.3" class="anchored" data-anchor-id="afexaov_看各时间点处理组成对比较和各处理组时间点成对比较">
<span class="header-section-number">8.3.2.3</span> <code>afex::aov_*()</code>看各时间点处理组成对比较和各处理组时间点成对比较</h4>
<p><a href="https://cran.r-project.org/web/packages/afex/vignettes/afex_anova_example.html" class="uri">https://cran.r-project.org/web/packages/afex/vignettes/afex_anova_example.html</a></p>
<div class="cell">
<details open="" class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://afex.singmann.science/">"afex"</a></span><span class="op">)</span>     </span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://rvlenth.github.io/emmeans/">"emmeans"</a></span><span class="op">)</span> </span>
<span><span class="co"># aov_car(SBP ~ group + Error(id/time), data = SBP_long)</span></span>
<span><span class="co"># aov_4(SBP ~ group + (time|id), data = SBP_long)</span></span>
<span></span>
<span><span class="va">SBP_aovez</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/afex/man/aov_car.html">aov_ez</a></span><span class="op">(</span>id <span class="op">=</span> <span class="st">"id"</span>,</span>
<span>                    dv <span class="op">=</span>  <span class="st">"SBP"</span>,</span>
<span>                    data <span class="op">=</span>  <span class="va">SBP_long</span>, </span>
<span>                    between <span class="op">=</span><span class="st">"group"</span> , </span>
<span>                    within <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"time"</span><span class="op">)</span></span>
<span>                    <span class="op">)</span></span>
<span><span class="va">SBP_aovez</span></span>
<span><span class="co">#&gt; Anova Table (Type 3 tests)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Response: SBP</span></span>
<span><span class="co">#&gt;       Effect          df   MSE          F  ges p.value</span></span>
<span><span class="co">#&gt; 1      group       2, 12 78.87     5.78 * .430    .017</span></span>
<span><span class="co">#&gt; 2       time 2.71, 32.58  8.08 106.56 *** .659   &lt;.001</span></span>
<span><span class="co">#&gt; 3 group:time 5.43, 32.58  8.08  19.10 *** .409   &lt;.001</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '+' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Sphericity correction method: GG</span></span>
<span></span>
<span><span class="va">SBP_aovez</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Univariate Type III Repeated-Measures ANOVA Assuming Sphericity</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;              Sum Sq num Df Error SS den Df    F value    Pr(&gt;F)    </span></span>
<span><span class="co">#&gt; (Intercept) 1155433      1   946.48     12 14649.2234 &lt; 2.2e-16 ***</span></span>
<span><span class="co">#&gt; group           912      2   946.48     12     5.7829   0.01743 *  </span></span>
<span><span class="co">#&gt; time           2336      4   263.12     48   106.5576 &lt; 2.2e-16 ***</span></span>
<span><span class="co">#&gt; group:time      838      8   263.12     48    19.1006 1.621e-12 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Mauchly Tests for Sphericity</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;            Test statistic p-value</span></span>
<span><span class="co">#&gt; time              0.29307 0.17766</span></span>
<span><span class="co">#&gt; group:time        0.29307 0.17766</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Greenhouse-Geisser and Huynh-Feldt Corrections</span></span>
<span><span class="co">#&gt;  for Departure from Sphericity</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;             GG eps Pr(&gt;F[GG])    </span></span>
<span><span class="co">#&gt; time       0.67869  &lt; 2.2e-16 ***</span></span>
<span><span class="co">#&gt; group:time 0.67869  4.263e-09 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;              HF eps   Pr(&gt;F[HF])</span></span>
<span><span class="co">#&gt; time       0.896371 4.649080e-21</span></span>
<span><span class="co">#&gt; group:time 0.896371 2.041727e-11</span></span>
<span></span>
<span><span class="co"># 多变量检验</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">SBP_aovez</span><span class="op">$</span><span class="va">Anova</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Type III Repeated Measures MANOVA Tests:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ------------------------------------------</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Term: (Intercept) </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Response transformation matrix:</span></span>
<span><span class="co">#&gt;    (Intercept)</span></span>
<span><span class="co">#&gt; t0           1</span></span>
<span><span class="co">#&gt; t1           1</span></span>
<span><span class="co">#&gt; t2           1</span></span>
<span><span class="co">#&gt; t3           1</span></span>
<span><span class="co">#&gt; t4           1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Sum of squares and products for the hypothesis:</span></span>
<span><span class="co">#&gt;             (Intercept)</span></span>
<span><span class="co">#&gt; (Intercept)     5777165</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Multivariate Tests: (Intercept)</span></span>
<span><span class="co">#&gt;                  Df test stat approx F num Df den Df     Pr(&gt;F)    </span></span>
<span><span class="co">#&gt; Pillai            1    0.9992 14649.22      1     12 &lt; 2.22e-16 ***</span></span>
<span><span class="co">#&gt; Wilks             1    0.0008 14649.22      1     12 &lt; 2.22e-16 ***</span></span>
<span><span class="co">#&gt; Hotelling-Lawley  1 1220.7686 14649.22      1     12 &lt; 2.22e-16 ***</span></span>
<span><span class="co">#&gt; Roy               1 1220.7686 14649.22      1     12 &lt; 2.22e-16 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ------------------------------------------</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Term: group </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Response transformation matrix:</span></span>
<span><span class="co">#&gt;    (Intercept)</span></span>
<span><span class="co">#&gt; t0           1</span></span>
<span><span class="co">#&gt; t1           1</span></span>
<span><span class="co">#&gt; t2           1</span></span>
<span><span class="co">#&gt; t3           1</span></span>
<span><span class="co">#&gt; t4           1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Sum of squares and products for the hypothesis:</span></span>
<span><span class="co">#&gt;             (Intercept)</span></span>
<span><span class="co">#&gt; (Intercept)      4561.2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Multivariate Tests: group</span></span>
<span><span class="co">#&gt;                  Df test stat approx F num Df den Df   Pr(&gt;F)  </span></span>
<span><span class="co">#&gt; Pillai            2 0.4907894 5.782943      2     12 0.017434 *</span></span>
<span><span class="co">#&gt; Wilks             2 0.5092106 5.782943      2     12 0.017434 *</span></span>
<span><span class="co">#&gt; Hotelling-Lawley  2 0.9638239 5.782943      2     12 0.017434 *</span></span>
<span><span class="co">#&gt; Roy               2 0.9638239 5.782943      2     12 0.017434 *</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ------------------------------------------</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Term: time </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Response transformation matrix:</span></span>
<span><span class="co">#&gt;    time1 time2 time3 time4</span></span>
<span><span class="co">#&gt; t0     1     0     0     0</span></span>
<span><span class="co">#&gt; t1     0     1     0     0</span></span>
<span><span class="co">#&gt; t2     0     0     1     0</span></span>
<span><span class="co">#&gt; t3     0     0     0     1</span></span>
<span><span class="co">#&gt; t4    -1    -1    -1    -1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Sum of squares and products for the hypothesis:</span></span>
<span><span class="co">#&gt;           time1     time2     time3     time4</span></span>
<span><span class="co">#&gt; time1  552.0667  952.4667  958.5333 -303.3333</span></span>
<span><span class="co">#&gt; time2  952.4667 1643.2667 1653.7333 -523.3333</span></span>
<span><span class="co">#&gt; time3  958.5333 1653.7333 1664.2667 -526.6667</span></span>
<span><span class="co">#&gt; time4 -303.3333 -523.3333 -526.6667  166.6667</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Multivariate Tests: time</span></span>
<span><span class="co">#&gt;                  Df test stat approx F num Df den Df     Pr(&gt;F)    </span></span>
<span><span class="co">#&gt; Pillai            1   0.98255 126.6592      4      9 6.6475e-08 ***</span></span>
<span><span class="co">#&gt; Wilks             1   0.01745 126.6592      4      9 6.6475e-08 ***</span></span>
<span><span class="co">#&gt; Hotelling-Lawley  1  56.29299 126.6592      4      9 6.6475e-08 ***</span></span>
<span><span class="co">#&gt; Roy               1  56.29299 126.6592      4      9 6.6475e-08 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ------------------------------------------</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Term: group:time </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Response transformation matrix:</span></span>
<span><span class="co">#&gt;    time1 time2 time3 time4</span></span>
<span><span class="co">#&gt; t0     1     0     0     0</span></span>
<span><span class="co">#&gt; t1     0     1     0     0</span></span>
<span><span class="co">#&gt; t2     0     0     1     0</span></span>
<span><span class="co">#&gt; t3     0     0     0     1</span></span>
<span><span class="co">#&gt; t4    -1    -1    -1    -1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Sum of squares and products for the hypothesis:</span></span>
<span><span class="co">#&gt;          time1    time2    time3    time4</span></span>
<span><span class="co">#&gt; time1 524.9333 284.3333 507.0667 534.3333</span></span>
<span><span class="co">#&gt; time2 284.3333 184.1333 227.4667 396.3333</span></span>
<span><span class="co">#&gt; time3 507.0667 227.4667 563.7333 348.6667</span></span>
<span><span class="co">#&gt; time4 534.3333 396.3333 348.6667 923.3333</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Multivariate Tests: group:time</span></span>
<span><span class="co">#&gt;                  Df test stat approx F num Df den Df     Pr(&gt;F)    </span></span>
<span><span class="co">#&gt; Pillai            2  1.808841 23.65627      8     20 1.3857e-08 ***</span></span>
<span><span class="co">#&gt; Wilks             2  0.008458 22.21451      8     18 7.9942e-08 ***</span></span>
<span><span class="co">#&gt; Hotelling-Lawley  2 20.599670 20.59967      8     16 4.8560e-07 ***</span></span>
<span><span class="co">#&gt; Roy               2 13.375814 33.43953      4     10 9.2057e-06 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Univariate Type III Repeated-Measures ANOVA Assuming Sphericity</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;              Sum Sq num Df Error SS den Df    F value    Pr(&gt;F)    </span></span>
<span><span class="co">#&gt; (Intercept) 1155433      1   946.48     12 14649.2234 &lt; 2.2e-16 ***</span></span>
<span><span class="co">#&gt; group           912      2   946.48     12     5.7829   0.01743 *  </span></span>
<span><span class="co">#&gt; time           2336      4   263.12     48   106.5576 &lt; 2.2e-16 ***</span></span>
<span><span class="co">#&gt; group:time      838      8   263.12     48    19.1006 1.621e-12 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Mauchly Tests for Sphericity</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;            Test statistic p-value</span></span>
<span><span class="co">#&gt; time              0.29307 0.17766</span></span>
<span><span class="co">#&gt; group:time        0.29307 0.17766</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Greenhouse-Geisser and Huynh-Feldt Corrections</span></span>
<span><span class="co">#&gt;  for Departure from Sphericity</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;             GG eps Pr(&gt;F[GG])    </span></span>
<span><span class="co">#&gt; time       0.67869  &lt; 2.2e-16 ***</span></span>
<span><span class="co">#&gt; group:time 0.67869  4.263e-09 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;              HF eps   Pr(&gt;F[HF])</span></span>
<span><span class="co">#&gt; time       0.896371 4.649080e-21</span></span>
<span><span class="co">#&gt; group:time 0.896371 2.041727e-11</span></span>
<span><span class="co"># 事后检验 不调整与SPSS一样</span></span>
<span></span>
<span><span class="co">## 看各时间点处理组成对比较</span></span>
<span><span class="fu">emmeans</span><span class="fu">::</span><span class="fu"><a href="https://rvlenth.github.io/emmeans/reference/emmeans.html">emmeans</a></span><span class="op">(</span><span class="va">SBP_aovez</span> ,  <span class="op">~</span> <span class="va">group</span><span class="op">|</span><span class="va">time</span>, adjust <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html">pairs</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; time = t0:</span></span>
<span><span class="co">#&gt;  contrast estimate   SE df t.ratio p.value</span></span>
<span><span class="co">#&gt;  A - B        -0.2 2.43 12  -0.082  0.9963</span></span>
<span><span class="co">#&gt;  A - C        -5.2 2.43 12  -2.137  0.1238</span></span>
<span><span class="co">#&gt;  B - C        -5.0 2.43 12  -2.055  0.1415</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time = t1:</span></span>
<span><span class="co">#&gt;  contrast estimate   SE df t.ratio p.value</span></span>
<span><span class="co">#&gt;  A - B        -7.4 3.13 12  -2.364  0.0847</span></span>
<span><span class="co">#&gt;  A - C       -10.6 3.13 12  -3.386  0.0139</span></span>
<span><span class="co">#&gt;  B - C        -3.2 3.13 12  -1.022  0.5776</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time = t2:</span></span>
<span><span class="co">#&gt;  contrast estimate   SE df t.ratio p.value</span></span>
<span><span class="co">#&gt;  A - B         0.4 2.95 12   0.136  0.9899</span></span>
<span><span class="co">#&gt;  A - C        -0.2 2.95 12  -0.068  0.9975</span></span>
<span><span class="co">#&gt;  B - C        -0.6 2.95 12  -0.204  0.9774</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time = t3:</span></span>
<span><span class="co">#&gt;  contrast estimate   SE df t.ratio p.value</span></span>
<span><span class="co">#&gt;  A - B        -2.4 3.11 12  -0.771  0.7272</span></span>
<span><span class="co">#&gt;  A - C       -16.8 3.11 12  -5.396  0.0004</span></span>
<span><span class="co">#&gt;  B - C       -14.4 3.11 12  -4.625  0.0016</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time = t4:</span></span>
<span><span class="co">#&gt;  contrast estimate   SE df t.ratio p.value</span></span>
<span><span class="co">#&gt;  A - B       -14.4 2.50 12  -5.771  0.0002</span></span>
<span><span class="co">#&gt;  A - C        -9.8 2.50 12  -3.927  0.0053</span></span>
<span><span class="co">#&gt;  B - C         4.6 2.50 12   1.843  0.1975</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; P value adjustment: tukey method for comparing a family of 3 estimates</span></span>
<span></span>
<span></span>
<span></span>
<span><span class="co">## 看各处理组时间点成对比较</span></span>
<span><span class="fu">emmeans</span><span class="fu">::</span><span class="fu"><a href="https://rvlenth.github.io/emmeans/reference/emmeans.html">emmeans</a></span><span class="op">(</span><span class="va">SBP_aovez</span> , <span class="va">pairwise</span> <span class="op">~</span> <span class="va">time</span><span class="op">|</span> <span class="va">group</span>, adjust <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span><span class="co">#&gt; $emmeans</span></span>
<span><span class="co">#&gt; group = A:</span></span>
<span><span class="co">#&gt;  time emmean   SE df lower.CL upper.CL</span></span>
<span><span class="co">#&gt;  t0      121 1.72 12      117      125</span></span>
<span><span class="co">#&gt;  t1      112 2.21 12      108      117</span></span>
<span><span class="co">#&gt;  t2      118 2.08 12      114      123</span></span>
<span><span class="co">#&gt;  t3      126 2.20 12      121      131</span></span>
<span><span class="co">#&gt;  t4      121 1.76 12      117      125</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; group = B:</span></span>
<span><span class="co">#&gt;  time emmean   SE df lower.CL upper.CL</span></span>
<span><span class="co">#&gt;  t0      121 1.72 12      117      125</span></span>
<span><span class="co">#&gt;  t1      120 2.21 12      115      125</span></span>
<span><span class="co">#&gt;  t2      118 2.08 12      113      123</span></span>
<span><span class="co">#&gt;  t3      128 2.20 12      123      133</span></span>
<span><span class="co">#&gt;  t4      135 1.76 12      131      139</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; group = C:</span></span>
<span><span class="co">#&gt;  time emmean   SE df lower.CL upper.CL</span></span>
<span><span class="co">#&gt;  t0      126 1.72 12      122      130</span></span>
<span><span class="co">#&gt;  t1      123 2.21 12      118      128</span></span>
<span><span class="co">#&gt;  t2      119 2.08 12      114      123</span></span>
<span><span class="co">#&gt;  t3      143 2.20 12      138      147</span></span>
<span><span class="co">#&gt;  t4      131 1.76 12      127      134</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Confidence level used: 0.95 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $contrasts</span></span>
<span><span class="co">#&gt; group = A:</span></span>
<span><span class="co">#&gt;  contrast estimate    SE df t.ratio p.value</span></span>
<span><span class="co">#&gt;  t0 - t1       8.6 1.490 12   5.772  0.0001</span></span>
<span><span class="co">#&gt;  t0 - t2       2.6 1.320 12   1.964  0.0732</span></span>
<span><span class="co">#&gt;  t0 - t3      -4.8 2.060 12  -2.333  0.0379</span></span>
<span><span class="co">#&gt;  t0 - t4       0.2 1.680 12   0.119  0.9074</span></span>
<span><span class="co">#&gt;  t1 - t2      -6.0 0.913 12  -6.573  &lt;.0001</span></span>
<span><span class="co">#&gt;  t1 - t3     -13.4 1.060 12 -12.624  &lt;.0001</span></span>
<span><span class="co">#&gt;  t1 - t4      -8.4 1.530 12  -5.507  0.0001</span></span>
<span><span class="co">#&gt;  t2 - t3      -7.4 1.460 12  -5.066  0.0003</span></span>
<span><span class="co">#&gt;  t2 - t4      -2.4 1.340 12  -1.789  0.0989</span></span>
<span><span class="co">#&gt;  t3 - t4       5.0 1.630 12   3.062  0.0099</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; group = B:</span></span>
<span><span class="co">#&gt;  contrast estimate    SE df t.ratio p.value</span></span>
<span><span class="co">#&gt;  t0 - t1       1.4 1.490 12   0.940  0.3659</span></span>
<span><span class="co">#&gt;  t0 - t2       3.2 1.320 12   2.417  0.0325</span></span>
<span><span class="co">#&gt;  t0 - t3      -7.0 2.060 12  -3.402  0.0052</span></span>
<span><span class="co">#&gt;  t0 - t4     -14.0 1.680 12  -8.317  &lt;.0001</span></span>
<span><span class="co">#&gt;  t1 - t2       1.8 0.913 12   1.972  0.0721</span></span>
<span><span class="co">#&gt;  t1 - t3      -8.4 1.060 12  -7.914  &lt;.0001</span></span>
<span><span class="co">#&gt;  t1 - t4     -15.4 1.530 12 -10.096  &lt;.0001</span></span>
<span><span class="co">#&gt;  t2 - t3     -10.2 1.460 12  -6.983  &lt;.0001</span></span>
<span><span class="co">#&gt;  t2 - t4     -17.2 1.340 12 -12.820  &lt;.0001</span></span>
<span><span class="co">#&gt;  t3 - t4      -7.0 1.630 12  -4.287  0.0011</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; group = C:</span></span>
<span><span class="co">#&gt;  contrast estimate    SE df t.ratio p.value</span></span>
<span><span class="co">#&gt;  t0 - t1       3.2 1.490 12   2.148  0.0529</span></span>
<span><span class="co">#&gt;  t0 - t2       7.6 1.320 12   5.740  0.0001</span></span>
<span><span class="co">#&gt;  t0 - t3     -16.4 2.060 12  -7.971  &lt;.0001</span></span>
<span><span class="co">#&gt;  t0 - t4      -4.4 1.680 12  -2.614  0.0226</span></span>
<span><span class="co">#&gt;  t1 - t2       4.4 0.913 12   4.820  0.0004</span></span>
<span><span class="co">#&gt;  t1 - t3     -19.6 1.060 12 -18.465  &lt;.0001</span></span>
<span><span class="co">#&gt;  t1 - t4      -7.6 1.530 12  -4.982  0.0003</span></span>
<span><span class="co">#&gt;  t2 - t3     -24.0 1.460 12 -16.432  &lt;.0001</span></span>
<span><span class="co">#&gt;  t2 - t4     -12.0 1.340 12  -8.944  &lt;.0001</span></span>
<span><span class="co">#&gt;  t3 - t4      12.0 1.630 12   7.348  &lt;.0001</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section></section><section id="分部计算" class="level3" data-number="8.3.3"><h3 data-number="8.3.3" class="anchored" data-anchor-id="分部计算">
<span class="header-section-number">8.3.3</span> 分部计算</h3>
<p><span class="math display">\[
\begin{aligned}
SS_总&amp;= SS_{受试对象间}+SS_{受试对象内}  \\
&amp;=（SS_{处理方法}+SS_{个体间差异}）+（SS_{时间}+SS_{处理与时间交互}+SS_{个体内差异}）
\end{aligned}
\]</span></p>
<p><span class="math display">\[
\begin{aligned}
\nu_总&amp;= \nu_{受试对象间}+\nu_{受试对象内}  \\
&amp;=（\nu_{处理方法}+\nu_{个体差异}）+（\nu_{时间}+\nu_{处理与时间交互}+\nu_{个体差异}）
\end{aligned}
\]</span></p>
<table class="caption-top table">
<colgroup>
<col style="width: 15%">
<col style="width: 20%">
<col style="width: 16%">
<col style="width: 14%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 12%">
</colgroup>
<thead><tr class="header">
<th>Page 86-87</th>
<th>变异</th>
<th>SS</th>
<th>v</th>
<th>MS</th>
<th>F</th>
<th>CP</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>受试对象间</td>
<td>处理</td>
<td><strong>912.24</strong></td>
<td>2</td>
<td>456.12</td>
<td>5.78</td>
<td>0.0174</td>
</tr>
<tr class="even">
<td></td>
<td>个体差异</td>
<td>946.48</td>
<td>12</td>
<td>78.87</td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td></td>
<td></td>
<td><strong>1858.72</strong></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>受试对象内</td>
<td>时间</td>
<td><strong>2336.45</strong></td>
<td>4</td>
<td>584.11</td>
<td>106.56</td>
<td>&lt;0.0001</td>
</tr>
<tr class="odd">
<td></td>
<td>处理与时间交互</td>
<td><strong>837.63</strong></td>
<td>8</td>
<td>104.70</td>
<td>19.10</td>
<td>&lt;0.0001</td>
</tr>
<tr class="even">
<td></td>
<td>个体差异</td>
<td>263.12</td>
<td>48</td>
<td>5.48</td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td></td>
<td></td>
<td><strong>3437.2</strong></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>总</td>
<td></td>
<td><strong>5295.92</strong></td>
<td>3×15-1=74</td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<section id="ss总" class="level4" data-number="8.3.3.1"><h4 data-number="8.3.3.1" class="anchored" data-anchor-id="ss总">
<span class="header-section-number">8.3.3.1</span> SS<sub>总</sub>
</h4>
<p><span class="math display">\[
SS_总=\sum_i^n{（X_i-\bar X）^2}
\]</span></p>
<p>其中，n是观测值的总数，Xi 为每个观测值，<span class="math inline">\(\bar X\)</span> 是所有观测值的均值。</p>
<div class="cell">
<details open="" class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span></span>
<span><span class="va">SBP_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">SBP</span><span class="op">$</span><span class="va">t0</span>,<span class="va">SBP</span><span class="op">$</span><span class="va">t1</span>,<span class="va">SBP</span><span class="op">$</span><span class="va">t2</span>,<span class="va">SBP</span><span class="op">$</span><span class="va">t3</span>,<span class="va">SBP</span><span class="op">$</span><span class="va">t4</span><span class="op">)</span></span>
<span></span>
<span><span class="va">SBP_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">SBP_data</span><span class="op">)</span></span>
<span></span>
<span><span class="va">SS_total</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">SBP_data</span><span class="op">-</span><span class="va">SBP_mean</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">SS_total</span>    </span>
<span><span class="co">#&gt; [1] 5295.92</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="ss受试对象间" class="level4" data-number="8.3.3.2"><h4 data-number="8.3.3.2" class="anchored" data-anchor-id="ss受试对象间">
<span class="header-section-number">8.3.3.2</span> SS<sub>受试对象间</sub>
</h4>
<p><span class="math display">\[
SS_{受试对象间}=\sum_{j=1}^m n_{.j}(\bar X_{.j}-\bar X)^2
\]</span></p>
<p>其中，m是受试者数量（15），n<sub>.j</sub> 是第j 个受试对象的观测值数量，<span class="math inline">\(\bar X.j\)</span>是第j 个受试对象的观测值的均值，<span class="math inline">\(\bar X\)</span> 是所有观测值的均值。</p>
<div class="cell">
<details open="" class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">id_mean</span> <span class="op">&lt;-</span> <span class="va">SBP</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="op">-</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowMeans</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">SS_between</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">SBP</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">SS_between</span> <span class="op">&lt;-</span> <span class="va">SS_between</span> <span class="op">+</span> <span class="fl">5</span><span class="op">*</span><span class="op">(</span><span class="va">id_mean</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">-</span><span class="va">SBP_mean</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span></span>
<span><span class="op">}</span></span>
<span><span class="va">SS_between</span></span>
<span><span class="co">#&gt; [1] 1858.72</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">group__summary</span> <span class="op">&lt;-</span> <span class="va">SBP_long</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">group</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">summarise</span><span class="op">(</span>n<span class="op">=</span><span class="fu">n</span><span class="op">(</span><span class="op">)</span>,mean<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">SBP</span><span class="op">)</span>,sum<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">SBP</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">group__summary</span> </span>
<span><span class="co">#&gt; # A tibble: 3 × 4</span></span>
<span><span class="co">#&gt;   group     n  mean   sum</span></span>
<span><span class="co">#&gt;   &lt;fct&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 A        25  120.  2992</span></span>
<span><span class="co">#&gt; 2 B        25  124.  3112</span></span>
<span><span class="co">#&gt; 3 C        25  128.  3205</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="ss处理" class="level5"><h5 class="anchored" data-anchor-id="ss处理">SS<sub>处理</sub>
</h5>
<p><span class="math display">\[
SS_{处理}= \sum_i^k n_k (\bar X_k - \bar X)^2
\]</span></p>
<p>其中，k为不同处理组的组数，n<sub>k</sub> 为第 k 处理组观测值的总数，<span class="math inline">\(\bar  X_k\)</span> 为第k 处理组观测值的均数，<span class="math inline">\(\bar X\)</span> 是所有观测值的均值。</p>
<div class="cell">
<details open="" class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">SS_处理</span> <span class="op">&lt;-</span> <span class="fl">25</span><span class="op">*</span><span class="op">(</span> <span class="op">(</span><span class="va">group__summary</span><span class="op">$</span><span class="va">mean</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">SBP_mean</span> <span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> </span>
<span>                       <span class="op">(</span><span class="va">group__summary</span><span class="op">$</span><span class="va">mean</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">-</span> <span class="va">SBP_mean</span> <span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span></span>
<span>                       <span class="op">(</span><span class="va">group__summary</span><span class="op">$</span><span class="va">mean</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">-</span> <span class="va">SBP_mean</span> <span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> </span>
<span><span class="va">SS_处理</span></span>
<span><span class="co">#&gt; [1] 912.24</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">SS_between_error</span> <span class="op">&lt;-</span> <span class="va">SS_between</span><span class="op">-</span><span class="va">SS_处理</span></span>
<span></span>
<span><span class="va">SS_between_error</span></span>
<span><span class="co">#&gt; [1] 946.48</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section></section><section id="ss受试对象内" class="level4" data-number="8.3.3.3"><h4 data-number="8.3.3.3" class="anchored" data-anchor-id="ss受试对象内">
<span class="header-section-number">8.3.3.3</span> SS<sub>受试对象内</sub>
</h4>
<p><span class="math display">\[
SS_{受试对象内}=SS_总-SS_{受试对象间}
\]</span></p>
<div class="cell">
<details open="" class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">SS_within</span> <span class="op">&lt;-</span> <span class="va">SS_total</span><span class="op">-</span><span class="va">SS_between</span></span>
<span><span class="va">SS_within</span></span>
<span><span class="co">#&gt; [1] 3437.2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="ss时间" class="level5"><h5 class="anchored" data-anchor-id="ss时间">SS<sub>时间</sub>
</h5>
<p><span class="math display">\[
SS_{时间}=\sum _{t=1}^T n_t （\bar X_{.t}-\bar X）^2
\]</span></p>
<p>其中，T是时间点的数量，n<sub>t</sub> 是在时间点t的观测值数量，\bar X<sub>.t</sub> 是在时间点 t 的均值。</p>
<div class="cell">
<details open="" class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">t_mean</span> <span class="op">&lt;-</span> <span class="va">SBP</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="op">-</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">colMeans</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">SS_time</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span><span class="op">(</span><span class="va">t_mean</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    </span>
<span>    <span class="va">SS_time</span> <span class="op">&lt;-</span> <span class="va">SS_time</span> <span class="op">+</span> <span class="fl">15</span><span class="op">*</span><span class="op">(</span><span class="va">t_mean</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">-</span><span class="va">SBP_mean</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span></span>
<span>    </span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">SS_time</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"SS_time"</span></span>
<span><span class="va">SS_time</span></span>
<span><span class="co">#&gt;  SS_time </span></span>
<span><span class="co">#&gt; 2336.453</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="ss处理与时间交互" class="level5"><h5 class="anchored" data-anchor-id="ss处理与时间交互">SS<sub>处理与时间交互</sub>
</h5>
<p><span class="math display">\[
SS_{处理与时间交互}=\sum_{i=1}^{k}\sum_{j=1}^{T}n_{ij}\left (\bar X_{ij.} -\bar X_{i..}-\bar X_{.j.} + \bar X_{...} \right )^2
\]</span></p>
<p>其中，</p>
<ul>
<li><p>k 是处理方法的数量，3</p></li>
<li><p>T 是时间点的数量，5</p></li>
<li><p>n<sub>ij</sub> 是第 i 个处理方法和第 j 个时间点的观测次数，25/5=5</p></li>
<li><p>Xij <sub>.</sub> 是第 i 个处理方法、第 j 个时间点的观测值的平均值</p></li>
<li><p>X<sub>i&nbsp;.&nbsp;.</sub> 是第 i 个处理方法观测值的平均值，不考虑时间点</p></li>
<li><p>X<sub>.&nbsp;j&nbsp;.</sub> 是第 j 个时间点观测值的平均值，不考虑处理方法</p></li>
<li><p>X<sub>.&nbsp;.&nbsp;.</sub> 是所有观测值的平均值，不考虑处理方法和时间点</p></li>
</ul>
<div class="cell">
<details open="" class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">interaction_effect_summary</span> <span class="op">&lt;-</span> <span class="va">SBP_long</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">summarise</span><span class="op">(</span></span>
<span>        <span class="co">#n = n(),</span></span>
<span>        mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">SBP</span><span class="op">)</span>,</span>
<span>       <span class="co"># sum = sum(SBP),</span></span>
<span>        .by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">group</span> , <span class="va">time</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="va">interaction_effect_mean</span> <span class="op">&lt;-</span> <span class="va">interaction_effect_summary</span> <span class="op">|&gt;</span> <span class="fu">pivot_wider</span><span class="op">(</span>names_from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"time"</span><span class="op">)</span>,values_from <span class="op">=</span> <span class="st">"mean"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span></span>
<span><span class="va">SS_interaction_effect</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">SS_interaction_effect</span> <span class="op">&lt;-</span> <span class="va">SS_interaction_effect</span> <span class="op">+</span> <span class="fl">5</span> <span class="op">*</span> <span class="op">(</span><span class="va">interaction_effect_mean</span><span class="op">[</span><span class="va">i</span>, <span class="va">j</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span> <span class="op">-</span><span class="va">group__summary</span><span class="op">$</span><span class="va">mean</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">-</span> <span class="va">t_mean</span><span class="op">[</span><span class="va">j</span><span class="op">]</span> <span class="op">+</span> <span class="va">SBP_mean</span><span class="op">)</span> <span class="op">^</span> <span class="fl">2</span></span>
<span>    <span class="op">}</span></span>
<span>    </span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">SS_interaction_effect</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"SS_interaction_effect"</span></span>
<span><span class="va">SS_interaction_effect</span></span>
<span><span class="co">#&gt;   SS_interaction_effect</span></span>
<span><span class="co">#&gt; 1              837.6267</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">SS_within_error</span> <span class="op">&lt;-</span> <span class="va">SS_within</span><span class="op">-</span><span class="va">SS_time</span><span class="op">-</span><span class="va">SS_interaction_effect</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">SS_within_error</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"SS_within_error"</span></span>
<span><span class="va">SS_within_error</span> </span>
<span><span class="co">#&gt;   SS_within_error</span></span>
<span><span class="co">#&gt; 1          263.12</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section></section></section></section><section id="球形度检验-sphericity" class="level2" data-number="8.4"><h2 data-number="8.4" class="anchored" data-anchor-id="球形度检验-sphericity">
<span class="header-section-number">8.4</span> 球形度检验 sphericity</h2>
<p><em>重复测量方差</em>分析假设相关条件（或组水平）的所有组合之间的差异方差相等。这被称为<strong>球形度假设</strong>。</p>
<p><a href="https://www.datanovia.com/en/lessons/mauchlys-test-of-sphericity-in-r/">R中球形度检验</a></p>
<p>球度仅针对具有两个以上水平的变量进行评估，因为球形度必然适用于只有两个水平的条件。</p>
<p>违反球形度假设可能会扭曲方差计算，从而导致更宽松的重复测量方差分析检验（即 I 类错误率增加）。在这种情况下，必须根据违反球形度的程度适当校正重复测量方差分析。文献中使用了两种常见的校正：<strong>Greenhouse-Geisser epsilon</strong> （GGe） 和 <strong>Huynh-Feldt epsilon</strong> （HFe）。</p>
<p>球<strong>形度的 Mauchly 检验</strong>用于评估是否满足球形度的假设。使用<code><a href="https://rpkgs.datanovia.com/rstatix/reference/anova_test.html">rstatix::anova_test()</a></code> 时，会自动报告此问题。尽管该方法受到严厉批评，通常无法检测到小样本中的球形偏离，而在大样本中则过度检测到它们，但它仍然是一种常用的方法。</p>
<section id="计算步骤" class="level3" data-number="8.4.1"><h3 data-number="8.4.1" class="anchored" data-anchor-id="计算步骤">
<span class="header-section-number">8.4.1</span> 计算步骤</h3>
<p>具体操作步骤如下：</p>
<ol type="1">
<li><p>计算相关组的每个组合之间的差异</p></li>
<li><p>计算每个组差的方差</p></li>
</ol>
<p><img src="images/clipboard-2447647328.png" class="img-fluid"></p>
</section><section id="案例-1" class="level3" data-number="8.4.2"><h3 data-number="8.4.2" class="anchored" data-anchor-id="案例-1">
<span class="header-section-number">8.4.2</span> 案例</h3>
<section id="rstatixanova_test" class="level4" data-number="8.4.2.1"><h4 data-number="8.4.2.1" class="anchored" data-anchor-id="rstatixanova_test">
<span class="header-section-number">8.4.2.1</span> <code>rstatix::anova_test()</code>
</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span></span>
<span><span class="va">aov_SBP</span> <span class="op">&lt;-</span> <span class="fu">rstatix</span><span class="fu">::</span><span class="fu"><a href="https://rpkgs.datanovia.com/rstatix/reference/anova_test.html">anova_test</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">SBP_long</span>,</span>
<span>           dv <span class="op">=</span> <span class="va">SBP</span>,</span>
<span>           wid <span class="op">=</span> <span class="va">id</span>,</span>
<span>           within <span class="op">=</span> <span class="va">time</span>,</span>
<span>           between <span class="op">=</span> <span class="va">group</span></span>
<span>           <span class="op">)</span></span>
<span></span>
<span><span class="va">aov_SBP</span></span>
<span><span class="co">#&gt; ANOVA Table (type II tests)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $ANOVA</span></span>
<span><span class="co">#&gt;       Effect DFn DFd       F        p p&lt;.05   ges</span></span>
<span><span class="co">#&gt; 1      group   2  12   5.783 1.70e-02     * 0.430</span></span>
<span><span class="co">#&gt; 2       time   4  48 106.558 3.02e-23     * 0.659</span></span>
<span><span class="co">#&gt; 3 group:time   8  48  19.101 1.62e-12     * 0.409</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`Mauchly's Test for Sphericity`</span></span>
<span><span class="co">#&gt;       Effect     W     p p&lt;.05</span></span>
<span><span class="co">#&gt; 1       time 0.293 0.178      </span></span>
<span><span class="co">#&gt; 2 group:time 0.293 0.178      </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`Sphericity Corrections`</span></span>
<span><span class="co">#&gt;       Effect   GGe      DF[GG]    p[GG] p[GG]&lt;.05   HFe      DF[HF]    p[HF]</span></span>
<span><span class="co">#&gt; 1       time 0.679 2.71, 32.58 1.87e-16         * 0.896 3.59, 43.03 4.65e-21</span></span>
<span><span class="co">#&gt; 2 group:time 0.679 5.43, 32.58 4.26e-09         * 0.896 7.17, 43.03 2.04e-11</span></span>
<span><span class="co">#&gt;   p[HF]&lt;.05</span></span>
<span><span class="co">#&gt; 1         *</span></span>
<span><span class="co">#&gt; 2         *</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>输出是一个包含三个表的列表：</p>
<ol type="1">
<li><p>方差分析结果显示标有（generalized eta squared，ges）的列上的 p 值和效应大小;效应大小本质上是由于受试者内因素而忽略受试者效应而导致的变异量。</p></li>
<li><p>Mauchly Sphericity检验。仅报告具有 &gt;2 水平的变量或效应，因为球形度必然适用于只有 2 个水平的效应。原假设是组差的方差相等。因此，显著的 p 值 （p &lt; 0.05） 表示组差的方差不相等。</p></li>
<li><p>球度校正结果，以防我们无法维持球形度假设。提供了文献中使用的两种常见校正：Greenhouse-Geisser epsilon （GGe） 和 Huynh-Feldt epsilon （HFe） 及其相应的 p 值</p></li>
</ol></section><section id="ezezanova" class="level4" data-number="8.4.2.2"><h4 data-number="8.4.2.2" class="anchored" data-anchor-id="ezezanova">
<span class="header-section-number">8.4.2.2</span> <code>ez::ezANOVA()</code>
</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://github.com/mike-lawrence/ez">ez</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 进行重复测量方差分析</span></span>
<span><span class="va">aov_ez</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ez/man/ezANOVA.html">ezANOVA</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">SBP_long</span>,</span>
<span>                   dv <span class="op">=</span> <span class="va">SBP</span>,</span>
<span>                   wid <span class="op">=</span> <span class="va">id</span>,</span>
<span>                   within <span class="op">=</span> <span class="va">time</span>,</span>
<span>                   between <span class="op">=</span> <span class="va">group</span>,</span>
<span>                   detailed <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 查看球形检验结果</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">aov_ez</span><span class="op">)</span></span>
<span><span class="co">#&gt; $ANOVA</span></span>
<span><span class="co">#&gt;        Effect DFn DFd          SSn    SSd            F            p p&lt;.05</span></span>
<span><span class="co">#&gt; 1 (Intercept)   1  12 1155433.0800 946.48 14649.223396 6.784700e-20     *</span></span>
<span><span class="co">#&gt; 2       group   2  12     912.2400 946.48     5.782943 1.743351e-02     *</span></span>
<span><span class="co">#&gt; 3        time   4  48    2336.4533 263.12   106.557616 3.017101e-23     *</span></span>
<span><span class="co">#&gt; 4  group:time   8  48     837.6267 263.12    19.100638 1.621310e-12     *</span></span>
<span><span class="co">#&gt;         ges</span></span>
<span><span class="co">#&gt; 1 0.9989542</span></span>
<span><span class="co">#&gt; 2 0.4299287</span></span>
<span><span class="co">#&gt; 3 0.6588884</span></span>
<span><span class="co">#&gt; 4 0.4091519</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`Mauchly's Test for Sphericity`</span></span>
<span><span class="co">#&gt;       Effect         W         p p&lt;.05</span></span>
<span><span class="co">#&gt; 3       time 0.2930746 0.1776608      </span></span>
<span><span class="co">#&gt; 4 group:time 0.2930746 0.1776608      </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`Sphericity Corrections`</span></span>
<span><span class="co">#&gt;       Effect      GGe        p[GG] p[GG]&lt;.05      HFe        p[HF] p[HF]&lt;.05</span></span>
<span><span class="co">#&gt; 3       time 0.678693 1.867336e-16         * 0.896371 4.649080e-21         *</span></span>
<span><span class="co">#&gt; 4 group:time 0.678693 4.262529e-09         * 0.896371 2.041727e-11         *</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section></section><section id="当满足球形度假设时" class="level3" data-number="8.4.3"><h3 data-number="8.4.3" class="anchored" data-anchor-id="当满足球形度假设时">
<span class="header-section-number">8.4.3</span> <strong>当满足球形度假设时</strong>
</h3>
<p>球形度的 Mauchly 检验不显著 （p &gt; 0.05）;这表明，受试者内因素水平之间的差异方差是相等的。因此，我们可以假设协方差矩阵的球形度，并解释方差分析表中可用的标准输出。</p>
<div class="cell">
<details open="" class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Display ANOVA table</span></span>
<span><span class="va">aov_SBP</span><span class="op">$</span><span class="va">ANOVA</span></span>
<span><span class="co">#&gt;       Effect DFn DFd       F        p p&lt;.05   ges</span></span>
<span><span class="co">#&gt; 1      group   2  12   5.783 1.70e-02     * 0.430</span></span>
<span><span class="co">#&gt; 2       time   4  48 106.558 3.02e-23     * 0.659</span></span>
<span><span class="co">#&gt; 3 group:time   8  48  19.101 1.62e-12     * 0.409</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ul>
<li><p><code>F</code>表示我们正在与 F 分布（F 检验）进行比较; 分别表示 time 和 Error（time） 的自由度; 表示得到的 F 统计量值<code>(2, 18)81.8</code></p></li>
<li><p><code>p</code>指定 p 值</p></li>
<li><p><code>ges</code>（广义 eta 平方，etaov_SBP[g]）是效应大小（由于受试者内因素引起的变异量）</p></li>
</ul></section><section id="当违反球形度假设时" class="level3" data-number="8.4.4"><h3 data-number="8.4.4" class="anchored" data-anchor-id="当违反球形度假设时">
<span class="header-section-number">8.4.4</span> <strong>当违反球形度假设时</strong>
</h3>
<p>如果数据违反了球形度假设（即 Mauchly 检验，p &lt;= 0.05），则应解释表<code>sphericity corrections</code>中的结果，其中对自由度进行了调整，这会影响检验的统计显著性（即 p 值）。校正通过乘法和校正估计值（Greenhouse-Geisser （GG） 和 Huynh-Feldt （HF） ε 值）来应用。</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>epsilon 提供了球形度被侵犯的程度的度量。值为 1 表示不偏离球形度（组差的所有方差均相等）。违反球形度会导致 epsilon 值低于 1。epsilon 离 1 越远，违规越严重。</p>
</div>
</div>
<p>可以看出，即使在球形度校正（p[GG] &lt; 0.001，p[HF] &lt; 0.001）之后，平均自尊得分在不同时间点仍存在统计学差异。</p>
<p>在两种球形度校正方法中，Huynh-Feldt 校正被认为是最不保守的（高估了 epsilon），而 Greenhouse-Geisser 被认为是更保守的（当 epsilon 接近 1 时低估了 epsilon）。</p>
<p>一般建议使用 Greenhouse-Geisser 校正，特别是当 epsilon &lt; 0.75 时。在 epsilon 大于 0.75 的情况下，一些统计学家建议使用 Huynh-Feldt 校正 （Girden 1992）。</p>


</section></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = true;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./ANOVA.html" class="pagination-link" aria-label="方差分析">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">方差分析</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./proportion_test.html" class="pagination-link" aria-label="比例检验">
        <span class="nav-page-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">比例检验</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>